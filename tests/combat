#!/usr/bin/perl
#
# dicerolls
#
# ---   *   ---   *   ---

# deps

  use v5.36.0;
  use strict;
  use warnings;

  use Time::HiRes qw(usleep);
  use English qw(-no_match_vars);

  use lib $ENV{'ARPATH'}.'/lib/sys/';
  use Style;

  use lib $ENV{'ARPATH'}.'/lib/';
  use GF::Icon;
  use GF::Mode::ANSI;

  use lib $ENV{'ARPATH'}.'/THRONE/';
  use RPG::Attr;
  use RPG::Bar;

# ---   *   ---   *   ---

my $obar={
  color => 0b10000000,
  anim  => $GF::Icon::PAIN,

};

my $attr=RPG::Attr->new(

  base   => 8,
  curses => {
    'Blood Curse'=>5,

  },

  bar   => $obar,

);

my $f     = GF::Mode::ANSI->new_frame();
my $color = $f->bitcolor($obar->{color});

# ---   *   ---   *   ---

while($attr->{i} > 0) {

  $attr->mod_current(-2);

  while(! $attr->{bar}->{stop}) {

    my @bar = $attr->draw();
    my $y   = 29 - $#bar;

    map {
      print {*STDOUT} "\e[${y}H$color$ARG\e[0m";
      $y++;

    } @bar;

    STDOUT->flush();

    usleep(10000);

  };

};

say "\n\nYOU DIED";


# ---   *   ---   *   ---
1; # ret
